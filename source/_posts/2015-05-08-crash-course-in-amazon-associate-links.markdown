---
layout: post
title: "Crash Course in Amazon Associate Links"
author: Julian
date: 2015-05-08 17:25:13 -0700
comments: true
categories: [money, web]
---

I've spent some time this week learning about [Amazon's Associate][aa] (affiliates) program. There's a lot of information scattered around the internet covering strategies to maximize revenues, or how to integrate it into various blogging engines, but I couldn't find much that gave an overview of how it all works, especially when considering the different regional Amazon stores.

Here's my attempt at explaining it.

<!-- more -->

There are a few complications:

* Amazon operates in multiple regions.  
* User accounts are per region, and per subsidiary; they are not global. e.g. Amazon US and Audible US both have associate programs, but require separate sign up. (More confusing given that you can login to Audible using your Amazon account!)
* An Associate account is a regular account that has opted into the associate program.
* Amazon pays associates by Amazon Gift Cards, direct deposit to a bank account (but only in the region of a given Amazon store), or by check. They all have minimum payout thresholds, generally $10. Checks incur a $15 fee. Associates can opt to set a higher minimum payout threshold.
* Amazon has ["Amazon Standard Identification Numbers (ASINs)"][asin]
* [ASINs][ASIN] are unique, but not guaranteed to be the same across Amazon stores for a given product.
* Amazon associate links that you create have to contain two key pieces of information: a special token that identifies the associate, and the ASIN of the product being promoted.
* Associates can create as many tokens as they want to. This can be used to correlate earnings to different campaigns, or promotions, etc.

So when a visitor clicks on your associate link they'll end up on one of Amazon's sites.  If that person is already logged in, and has an account on the same Amazon site that your associate account belongs to then all is well: they'll end up on the product page you intended, and if they purchase the item you'll get a percentage.

But if the visitors account is with a different regional store, it will know that your token is not valid for that region and ignore it.  If the user purchases the item you won't get anything.

Worse, the [ASIN] you obtained from your Amazon regional store may not match the [ASIN] of the product in your visitors regional store. I'm not sure what happens in this case; it's not clear if the visitor ends up on a different (or non existent) product page or if Amazon does some cross-region [ASIN] matching magic. Whatever happens, you are not going to get any payment.

So if you know your site is regularly visited by people in several regions you need to sign up for accounts in each region, then opt in to each regions associate program. You also need to get the [ASIN] for the product in each region. Finally you need to add links for each region to your site. 

But now you're going to be presenting your site's visitors with a bevy of Amazon links, and if they click on the wrong one you still won't earn anything.

There is a thread of hope- in general the physical location of the browser will match the correct region for the Amazon store of the visitor.

Javascript can be used to geo-locate the IP address of the browser (for example [geolocator]) so in principle you could build a script that determines the visitors location and substitutes your associate token for that region.

That takes care of the associate token... but not the [ASIN]. We could look up the details of the product (using Amazon's product API) in the original region store and then apply some heuristics to find the [ASIN] in the visitor's region's store.

Javascript can do that too, right?

Unfortunately not. The [Same Origin Policy][sop] get's in the way. The [SOP] is a security measure that only allows Javascript scripts to communicate with the server from which they were loaded.  There are work-arounds, such as [JSONP], but they require support from the API provider. Unfortunately Amazon doesn't support [JSONP] for their product API.

The only way to take care of the [ASIN] conversion is to have your javascript call back to your server, and then have your server figure out the [ASIN] for the visitors region.  One implementation of such a proxy is this [Amazon Associate Link Localiser][aall] written in JavaScript and PHP.

This is why all the Amazon link localizers for CMSs have both a server-side part and some extra JavaScript.

Aside: I suspect that even after all the above, if someone is travelling outside of the region of their Amazon account the above will fail and again, you'll miss out on any potential revenue.

But that's not a lot of use for this site.  Right now this site is being generated by [Octopress]. There are no server-side scripts; it's all static HTML pages pre-generated by the [Octopress] script running on my computer.  This makes it easier (and cheaper) to find a host for, but precludes any server-side proxy. There are services, like [GeoRiot], that can take care of this for you, but I suspect they'd cost us more than what we'll make via associate sales.

It does seem that Amazon is, shall we say, not maximizing associates potential revenue in a global economy. 

The silver lining for us is that, at the time of writing this, most of our site visitors are from Canada. So one simple Amazon associate link will capture the majority of potential buyers we forward on.

Amazon product links can be added using Amazons [sitestripe], but instead I'm going to use this [Jekyll amazon plugin][jap]. This way there'll be less to do in the future if I do implement a server side proxy.


[aa]: https://associates.amazon.ca
[asin]: http://en.wikipedia.org/wiki/Amazon_Standard_Identification_Number
[geolocator]: https://github.com/onury/geolocator
[sop]: http://en.wikipedia.org/wiki/Same-origin_policy
[jsonp]: http://en.wikipedia.org/wiki/JSONP
[aall]: http://petewilliams.info/blog/2009/07/javascript-amazon-associate-link-localiser/
[Octopress]:http://octopress.org
[GeoRiot]: http://www.georiot.com/home
[sitestripe]: https://affiliate-program.amazon.com/gp/associates/join/landing/tools.html
[jap]: https://github.com/longkey1/jekyll-amazon-plugin